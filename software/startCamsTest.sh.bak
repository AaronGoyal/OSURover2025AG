#!/bin/bash

sudo modprobe v4l2loopback devices=6 video_nr=10,11,12,13,14,15 card_label="virtual" exclusive_caps=1, max_buffers=2
gst-launch-1.0 v4l2src device=/dev/rover/camera_infrared ! image/jpeg,width=640,height=480,framerate=30/1 ! jpegdec ! videoconvert ! v4l2sink device=/dev/video11 &
sleep 1
gst-launch-1.0 v4l2src device=/dev/rover/camera_chassis ! image/jpeg,width=640,height=480,framerate=30/1 ! jpegdec ! videoconvert ! v4l2sink device=/dev/video12 &
sleep 1
gst-launch-1.0 v4l2src device=/dev/rover/camera_main_navigation ! image/jpeg,width=1280,height=720,framerate=15/1 ! jpegdec ! videoconvert ! v4l2sink device=/dev/video13 &
sleep 1
gst-launch-1.0 v4l2src device=/dev/rover/camera_gripper_405_rgb ! video/x-raw,width=640,height=480,framerate=30/1 ! videoconvert ! v4l2sink device=/dev/video14 &
#sleep 1
#gst-launch-1.0 rtspsrc location=rtsp://192.168.1.11:554 ! video/x-raw,width=640,height=480,framerate=30/1 ! videoconvert ! v4l2sink device=/dev/video13 &

systemd-notify --ready

wait

